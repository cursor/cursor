# filename: accounting_new.py
# ØªØ§Ø±ÛŒØ®: 1402/11/20 - Ø¨Ø§Ø²Ù†ÙˆÛŒØ³ÛŒ Ø¨Ø§ Ù…Ø¹Ù…Ø§Ø±ÛŒ Ø¨Ù‡ØªØ±

class Karmand:
    def __init__(self, esm, hoghoogh_paye):
        self.esm = esm
        self.hoghoogh_paye = hoghoogh_paye
        self.mahaleh_ha = []

class ZamanKar:
    def __init__(self, saat_kar, saat_ezafe=0):
        self.saat_kar = saat_kar
        self.saat_ezafe = saat_ezafe

class MohasebehHoghoogh:
    def mohasebeh_nakhales(self, karmand, zaman_kar, hazineh=0):
        hoghoogh_asli = karmand.hoghoogh_paye * zaman_kar.saat_kar / 160
        
        if zaman_kar.saat_ezafe > 0:
            ezafe_kar = (karmand.hoghoogh_paye / 160) * 1.5 * zaman_kar.saat_ezafe
        else:
            ezafe_kar = 0
            
        return hoghoogh_asli + ezafe_kar + hazineh

class MohasebehMaliat:
    def __init__(self, darsad_maliat):
        self.darsad_maliat = darsad_maliat
    
    def mohasebeh_maliat(self, mablagh):
        return mablagh * self.darsad_maliat

class MahalehKonandeh:
    def __init__(self):
        self.mahaleh_ha = []
    
    def ezafe_mahaleh(self, karmand, mablagh, tozih):
        karmand.mahaleh_ha.append({
            'mablagh': mablagh,
            'tozih': tozih
        })
        return True

class SystemHesabdarJadid:
    def __init__(self):
        self.karmandan = []
        self.mohasebe_hoghoogh = MohasebehHoghoogh()
        self.mahaleh_konandeh = MahalehKonandeh()
    
    def sabt_karmand(self, karmand):
        self.karmandan.append(karmand)
        print(f"Ú©Ø§Ø±Ù…Ù†Ø¯ {karmand.esm} Ø«Ø¨Øª Ø´Ø¯")
    
    def pardakht_hoghoogh(self, karmand, zaman_kar, mohasebe_maliat, hazineh=0):
        # Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù†Ø§Ø®Ø§Ù„Øµ
        nakhales = self.mohasebe_hoghoogh.mohasebe_nakhales(karmand, zaman_kar, hazineh)
        
        # Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…Ø§Ù„ÛŒØ§Øª
        maliat = mohasebe_maliat.mohasebe_maliat(nakhales)
        
        # Ú©Ø³Ø± Ù…Ø§Ø¨Ù‡â€ŒØ§Ù„ØªÙØ§ÙˆØª
        kole_mahaleh = sum(mahaleh['mablagh'] for mahaleh in karmand.mahaleh_ha)
        
        # Ø­Ù‚ÙˆÙ‚ Ø®Ø§Ù„Øµ
        khaless = nakhales - maliat - kole_mahaleh
        
        natije = {
            'esm': karmand.esm,
            'nakhales': nakhales,
            'maliat': maliat,
            'mahaleh': kole_mahaleh,
            'khaless': khaless
        }
        
        return natije
    
    def gereport(self):
        print("=== Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯ Ø­Ø³Ø§Ø¨Ø¯Ø§Ø±ÛŒ ===")
        
        for karmand in self.karmandan:
            # Ø¨Ø±Ø§ÛŒ Ø³Ø§Ø¯Ú¯ÛŒ ÙØ±Ø¶ Ù…ÛŒÚ©Ù†ÛŒÙ… Ù‡Ù…Ù‡ Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ Ø«Ø§Ø¨Øª Ù‡Ø³ØªÙ†Ø¯
            zaman = ZamanKar(160, 10)
            maliat = MohasebehMaliat(0.1)
            natije = self.pardakht_hoghoogh(karmand, zaman, maliat, 1_000_000)
            
            print(f"{natije['esm']}: {natije['khaless']:,.0f} ØªÙˆÙ…Ø§Ù†")
            
            if karmand.mahaleh_ha:
                print(f"  Ú©Ø³ÙˆØ±Ø§Øª: {natije['mahaleh']:,.0f} ØªÙˆÙ…Ø§Ù†")

# Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯
print("ğŸš€ Ø³ÛŒØ³ØªÙ… Ø­Ø³Ø§Ø¨Ø¯Ø§Ø±ÛŒ Ø¬Ø¯ÛŒØ¯ - Ù†Ø³Ø®Ù‡ 2.0")

# Ø§ÛŒØ¬Ø§Ø¯ Ø³ÛŒØ³ØªÙ…
system_jadid = SystemHesabdarJadid()

# Ø«Ø¨Øª Ú©Ø§Ø±Ù…Ù†Ø¯Ù‡Ø§
karmand1 = Karmand("Ø¹Ù„ÛŒ Ø±Ø¶Ø§ÛŒÛŒ", 50_000_000)
karmand2 = Karmand("Ù…Ø±ÛŒÙ… Ø­Ø³ÛŒÙ†ÛŒ", 45_000_000)

system_jadid.sabt_karmand(karmand1)
system_jadid.sabt_karmand(karmand2)

# Ú©Ø³Ø± Ø¨ÛŒÙ…Ù‡ Ø¨Ø±Ø§ÛŒ Ø¹Ù„ÛŒ
system_jadid.mahaleh_konandeh.ezafe_mahaleh(karmand1, 500_000, "Ø¨ÛŒÙ…Ù‡")

# Ú¯Ø±ÙØªÙ† Ú¯Ø²Ø§Ø±Ø´
system_jadid.gereport()

# Ø­Ø§Ù„Ø§ Ø¨Ù‡ Ø±Ø§Ø­ØªÛŒ Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒÙ… Ù…Ø§Ù„ÛŒØ§Øª Ù…ØªÙØ§ÙˆØª Ø¨Ø±Ø§ÛŒ Ù‡Ø±Ú©Ø³ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒÙ…
print("\n--- Ø¨Ø§ Ù…Ø§Ù„ÛŒØ§Øª Ù…ØªÙØ§ÙˆØª ---")
maliat_pareh_time = MohasebehMaliat(0.05)  # Ù…Ø§Ù„ÛŒØ§Øª Ú©Ù…ØªØ± Ø¨Ø±Ø§ÛŒ Ù¾Ø§Ø±Ù‡ ÙˆÙ‚Øª
zaman_pareh = ZamanKar(120, 0)  # Ù¾Ø§Ø±Ù‡ ÙˆÙ‚Øª

karmand3 = Karmand("Ù†Ø§ØµØ± Ø§Ø­Ù…Ø¯ÛŒ", 30_000_000)
system_jadid.sabt_karmand(karmand3)

natije = system_jadid.pardakht_hoghoogh(karmand3, zaman_pareh, maliat_pareh_time)
print(f"{natije['esm']}: {natije['khaless']:,.0f} ØªÙˆÙ…Ø§Ù† (Ù¾Ø§Ø±Ù‡ ÙˆÙ‚Øª)")
